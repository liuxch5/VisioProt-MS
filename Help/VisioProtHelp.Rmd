---
title: "VisioProt - Utilisation manual"
author: "Marie Locard-Paulet"
date: '`r date()`' 
output: 
    html_document:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)

require(knitr)
require(kableExtra)
require(dplyr)
require(ggplot2)
```


## General description

VisioProt-MS plots the masses of eluting proteins as a function of their retention time to allow inspection and analysis of runs from liquid chromatography coupled to mass spectrometry (LC-MS). The Shiny-based web application VisioProt-MS is suitable for non-R users. It can be found on our [team\'s webpage](https://masstools.ipbs.fr/mstools/visioprot-ms/) and the corresponding scripts are accessible [here](https://github.com/mlocardpaulet/VisioProt-MS). It is governed by the [CeCILL license](http://www.cecill.info).

## Input files

Here are examples of the 3 supported format files (5 first rows of the input tables):

```{r}
tab1 <- read.table("files/Unique/OEJPA170302_93_Job_1_results.csv", sep = "\t", header = F, nrows = 5) # RoWinPro
tab2 <- read.table("files/test/TestBioPharma.txt", sep = "\t", header = T, nrows = 5) # BioPharma Finder
tab3 <- read.table("files/test/Std_Orexin_1-100_Slot2-46_01_1147_DeconvolutedPeaks.csv", sep = ",", header = F, skip = 2, nrows = 5)

k1 <- kable(tab1)
k2 <- kable(tab2)
k3 <- kable(tab3)
```

**RoWinPro export:**

`r kable_styling(k1, bootstrap_options = "striped", full_width = F)`

**Bruker export:**

`r kable_styling(k3, bootstrap_options = "striped", full_width = F)`

**BioPharma Finder export:**

```{r}
kable(tab2, "html") %>%
  kable_styling(font_size = 12) %>%
  scroll_box(width = "700px", height = "255px")
```

## Test mode

It is possible to check the box `Using test mode (to test the app. whithout input file-s)` to test the app without loading any input file. Upon checking the box, two buttons appear:


* `Single test file` uploads a test file in a RoWinPro format.
* `Multiple test files` uploads three files from a RoWinPro export. These are plotted together in order to be compared.


## General options



## Colours

Two sets of colour schemes are available for plotting single or multiple files:

**Colour schemes for single files:**

These have been chosen to visualise the signal intensities in a single file.

Spectral:

```{r}
# c("Spectral", "Red/yellow/blue", "Red/yellow/green", "yellow to red")
# c("Spectral", "RdYlBu", "RdYlGn", "YlOrRd")
gtab <- data.frame("x" = seq(1, 100, length.out = 100), "y" = rep(1, each = 100), stringsAsFactors = F)
```

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Spectral") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Red/yellow/blue:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "RdYlBu") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Red/yellow/green:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "RdYlGn") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

yellow to red:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "YlOrRd") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

**Colour schemes for multiple files:**

These have been chosen to differenciate the signal from the distinct files.

Set1:

```{r}
# "Set1" = "Set1",
# "Dark2" = "Dark2", 
# "Paired" = "Paired",
# "Accent" = "Accent",
# "Set2" = "Set2",
# "Set3" = "Set3
gtab <- data.frame("x" = seq(1, 9, length.out = 9), "y" = rep(1, each = 9), stringsAsFactors = F)
```

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Set1") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Set2:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Set2") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Set3:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Set3") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Dark2:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Dark2") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Paired:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Paired") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

Accent:

```{r, fig.height=1}
ggplot(gtab, aes(x=x, y=y, fill=x)) + geom_tile() + scale_fill_distiller(palette = "Accent") + theme(axis.line=element_blank(),
      axis.text.x=element_blank(),
      axis.text.y=element_blank(),
      axis.ticks=element_blank(),
      axis.title.x=element_blank(),
      axis.title.y=element_blank(),
      legend.position="none",
      panel.background=element_blank(),
      panel.border=element_blank(),
      panel.grid.major=element_blank(),
      panel.grid.minor=element_blank(),
      plot.background=element_blank())
```

